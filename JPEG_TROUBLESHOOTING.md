# JPEGè§£ç é—®é¢˜æ•…éšœæ’é™¤

## ğŸš¨ é”™è¯¯ä»£ç å«ä¹‰

æ‚¨é‡åˆ°çš„ "JPEG decode error: 1" è¡¨ç¤ºï¼š

### é”™è¯¯ä»£ç å¯¹ç…§è¡¨
- **é”™è¯¯ä»£ç  1**: å†…å­˜ä¸è¶³æˆ–JPEGæ ¼å¼é”™è¯¯
- **é”™è¯¯ä»£ç  2**: æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ  
- **é”™è¯¯ä»£ç  3**: æ–‡ä»¶æŸå
- **é”™è¯¯ä»£ç  4**: å‚æ•°é”™è¯¯

## ğŸ” é—®é¢˜åˆ†æ

### æ‚¨çš„å›¾ç‰‡ä¿¡æ¯
- **æ–‡ä»¶å**: Screenshot_202_161699.jpg
- **å°ºå¯¸**: 1080x2400 åƒç´ 
- **é—®é¢˜**: è¿™æ˜¯ä¸€ä¸ªé«˜åˆ†è¾¨ç‡çš„æ‰‹æœºæˆªå›¾

### ä¸»è¦é—®é¢˜
1. **å›¾ç‰‡å°ºå¯¸è¿‡å¤§**: 1080x2400 å¯¹ESP32æ¥è¯´å¤ªå¤§äº†
2. **å†…å­˜ä¸è¶³**: ESP32å†…å­˜æœ‰é™ï¼Œæ— æ³•å¤„ç†å¦‚æ­¤å¤§çš„å›¾ç‰‡
3. **å¯èƒ½çš„æ ¼å¼é—®é¢˜**: æŸäº›JPEGç¼–ç æ–¹å¼ESP32ä¸æ”¯æŒ

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: å›¾ç‰‡é¢„å¤„ç†ï¼ˆæ¨èï¼‰
åœ¨ä¸Šä¼ å‰å°†å›¾ç‰‡è°ƒæ•´åˆ°åˆé€‚çš„å°ºå¯¸ï¼š

**å»ºè®®å°ºå¯¸**:
- æœ€å¤§å®½åº¦: 320åƒç´ ï¼ˆå±å¹•å®½åº¦ï¼‰
- æœ€å¤§é«˜åº¦: 240åƒç´ ï¼ˆå±å¹•é«˜åº¦ï¼‰
- æˆ–è€…: 640x480ï¼ˆ2å€å±å¹•å°ºå¯¸ï¼‰

**å·¥å…·æ¨è**:
- **åœ¨çº¿å·¥å…·**: TinyPNG, Squoosh.app
- **Windows**: ç”»å›¾ã€IrfanView
- **Mac**: é¢„è§ˆåº”ç”¨
- **æ‰‹æœº**: ä»»ä½•å›¾ç‰‡ç¼–è¾‘åº”ç”¨

### æ–¹æ¡ˆ2: ç³»ç»Ÿè‡ªåŠ¨ç¼©æ”¾ï¼ˆå·²å®ç°ï¼‰
ç³»ç»Ÿç°åœ¨ä¼šè‡ªåŠ¨æ£€æµ‹å¤§å›¾ç‰‡å¹¶å°è¯•ç¼©æ”¾ï¼š

```cpp
// å¦‚æœå›¾ç‰‡å¾ˆå¤§ï¼Œè‡ªåŠ¨ä½¿ç”¨2å€ç¼©æ”¾
if (w > SCREEN_WIDTH * 2 || h > SCREEN_HEIGHT * 2) {
    scale = 2;
    TJpgDec.setJpgScale(scale);
}
```

### æ–¹æ¡ˆ3: å¢åŠ å†…å­˜æ£€æŸ¥ï¼ˆå·²å®ç°ï¼‰
ç³»ç»Ÿç°åœ¨ä¼šæ£€æŸ¥å¯ç”¨å†…å­˜ï¼š

```cpp
size_t freeHeap = ESP.getFreeHeap();
Serial.printf("Free heap: %d bytes\n", freeHeap);
```

## ğŸ“± æ‰‹æœºæˆªå›¾å¤„ç†æŒ‡å—

### é—®é¢˜æ ¹æº
æ‰‹æœºæˆªå›¾é€šå¸¸å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
- **é«˜åˆ†è¾¨ç‡**: 1080p, 2K, 4K
- **å¤§æ–‡ä»¶**: å‡ ç™¾KBåˆ°å‡ MB
- **ç‰¹æ®Šç¼–ç **: å¯èƒ½ä½¿ç”¨ESP32ä¸æ”¯æŒçš„JPEGå˜ä½“

### å¤„ç†æ­¥éª¤

#### 1. ä½¿ç”¨æ‰‹æœºè‡ªå¸¦å·¥å…·
**Android**:
1. æ‰“å¼€å›¾ç‰‡
2. ç‚¹å‡»ç¼–è¾‘
3. è°ƒæ•´å¤§å°åˆ° 640x480 æˆ–æ›´å°
4. ä¿å­˜

**iPhone**:
1. æ‰“å¼€ç…§ç‰‡åº”ç”¨
2. é€‰æ‹©å›¾ç‰‡ â†’ ç¼–è¾‘
3. è£å‰ªå¹¶è°ƒæ•´å¤§å°
4. å®Œæˆ

#### 2. ä½¿ç”¨åœ¨çº¿å·¥å…·
è®¿é—® [Squoosh.app](https://squoosh.app):
1. ä¸Šä¼ å›¾ç‰‡
2. è°ƒæ•´å°ºå¯¸åˆ° 320x240
3. é€‰æ‹©JPEGæ ¼å¼ï¼Œè´¨é‡80%
4. ä¸‹è½½å¤„ç†åçš„å›¾ç‰‡

#### 3. æ‰¹é‡å¤„ç†
å¦‚æœæœ‰å¤šå¼ å›¾ç‰‡ï¼Œæ¨èä½¿ç”¨ï¼š
- **IrfanView** (Windows) - æ‰¹é‡è½¬æ¢
- **ImageOptim** (Mac) - æ‰¹é‡ä¼˜åŒ–
- **XnConvert** (è·¨å¹³å°) - æ‰¹é‡å¤„ç†

## ğŸ› ï¸ ç³»ç»Ÿæ”¹è¿›

### å·²å®ç°çš„æ”¹è¿›

#### 1. æ™ºèƒ½ç¼©æ”¾
```cpp
// è‡ªåŠ¨æ£€æµ‹å¹¶ç¼©æ”¾å¤§å›¾ç‰‡
uint8_t scale = 1;
if (w > SCREEN_WIDTH * 2 || h > SCREEN_HEIGHT * 2) {
    scale = 2;  // ä½¿ç”¨2å€ç¼©æ”¾
}
```

#### 2. å†…å­˜ç›‘æ§
```cpp
// æ£€æŸ¥å¯ç”¨å†…å­˜
size_t freeHeap = ESP.getFreeHeap();
if (freeHeap < 50000) {  // å¦‚æœå†…å­˜ä¸è¶³50KB
    // æ˜¾ç¤ºå†…å­˜ä¸è¶³è­¦å‘Š
}
```

#### 3. æ–‡ä»¶éªŒè¯
```cpp
// éªŒè¯JPEGæ–‡ä»¶å¤´
if (header[0] == 0xFF && header[1] == 0xD8) {
    // æœ‰æ•ˆçš„JPEGæ–‡ä»¶
}
```

#### 4. è¯¦ç»†é”™è¯¯ä¿¡æ¯
ç°åœ¨ä¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯åŸå› ï¼š
- "å†…å­˜ä¸è¶³æˆ–æ ¼å¼é”™è¯¯"
- "æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ"
- "æ–‡ä»¶æŸå"
- "å‚æ•°é”™è¯¯"

## ğŸ“Š æ¨èè®¾ç½®

### å›¾ç‰‡è§„æ ¼å»ºè®®
| ç”¨é€” | æœ€å¤§å°ºå¯¸ | æ–‡ä»¶å¤§å° | è´¨é‡ |
|------|----------|----------|------|
| æ˜¾ç¤ºå±æ˜¾ç¤º | 320x240 | < 50KB | 80% |
| é«˜è´¨é‡æ˜¾ç¤º | 640x480 | < 200KB | 85% |
| å­˜å‚¨èŠ‚çœ | 160x120 | < 20KB | 70% |

### ESP32å†…å­˜ä½¿ç”¨
- **å¯ç”¨å†…å­˜**: ~280KB
- **JPEGè§£ç ç¼“å†²**: ~50-100KB
- **æ˜¾ç¤ºç¼“å†²**: ~150KB
- **ç³»ç»Ÿé¢„ç•™**: ~50KB

## ğŸ”„ æµ‹è¯•æ­¥éª¤

### 1. å‡†å¤‡æµ‹è¯•å›¾ç‰‡
åˆ›å»ºå‡ ä¸ªä¸åŒå°ºå¯¸çš„æµ‹è¯•å›¾ç‰‡ï¼š
- å°å›¾: 160x120, < 20KB
- ä¸­å›¾: 320x240, < 50KB  
- å¤§å›¾: 640x480, < 200KB

### 2. é€æ­¥æµ‹è¯•
1. å…ˆä¸Šä¼ æœ€å°çš„å›¾ç‰‡
2. æ£€æŸ¥ä¸²å£è¾“å‡º
3. ç¡®è®¤æ˜¾ç¤ºæ­£å¸¸
4. é€æ­¥æµ‹è¯•æ›´å¤§çš„å›¾ç‰‡

### 3. ç›‘æ§è¾“å‡º
æ³¨æ„ä¸²å£ä¸­çš„å…³é”®ä¿¡æ¯ï¼š
```
File size: 45678 bytes
Free heap: 234567 bytes
JPEG size: 1080x2400
Using scale factor: 2
Scaled JPEG size: 540x1200
Display position: (0, 0)
JPEG displayed successfully
```

## ğŸ¯ å¿«é€Ÿè§£å†³æ–¹æ¡ˆ

### ç«‹å³å¯è¡Œçš„æ–¹æ³•
1. **ä½¿ç”¨å°å›¾ç‰‡æµ‹è¯•**: æ‰¾ä¸€å¼ å°äº100KBçš„å›¾ç‰‡æµ‹è¯•
2. **åœ¨çº¿å‹ç¼©**: ä½¿ç”¨TinyPNGå‹ç¼©æ‚¨çš„æˆªå›¾
3. **è°ƒæ•´å°ºå¯¸**: å°†å›¾ç‰‡è°ƒæ•´åˆ°320x240
4. **é‡æ–°ä¸Šä¼ **: ä½¿ç”¨å¤„ç†åçš„å›¾ç‰‡

### é•¿æœŸè§£å†³æ–¹æ¡ˆ
1. **å‰ç«¯é¢„å¤„ç†**: åœ¨ä¸Šä¼ å‰è‡ªåŠ¨å‹ç¼©å›¾ç‰‡
2. **æœåŠ¡å™¨ç«¯å¤„ç†**: ESP32æ¥æ”¶åè‡ªåŠ¨å¤„ç†
3. **å­˜å‚¨ä¼˜åŒ–**: ä½¿ç”¨æ›´é«˜æ•ˆçš„å›¾ç‰‡æ ¼å¼

## ğŸ“ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

1. **æ£€æŸ¥å†…å­˜**: é‡å¯ESP32é‡Šæ”¾å†…å­˜
2. **å°è¯•BMP**: å°†å›¾ç‰‡è½¬æ¢ä¸ºBMPæ ¼å¼æµ‹è¯•
3. **å‡å°å°ºå¯¸**: å°è¯•æ›´å°çš„å›¾ç‰‡ï¼ˆå¦‚64x64ï¼‰
4. **æŸ¥çœ‹æ—¥å¿—**: æä¾›å®Œæ•´çš„ä¸²å£è¾“å‡ºæ—¥å¿—

è®°ä½ï¼šESP32æ˜¯å¾®æ§åˆ¶å™¨ï¼Œå¤„ç†èƒ½åŠ›æœ‰é™ã€‚å°†å›¾ç‰‡è°ƒæ•´åˆ°åˆé€‚çš„å°ºå¯¸æ˜¯æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼
